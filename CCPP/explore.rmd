---
title: "BDA - Project"
authors: "Khang Nguyen, Son Le"
output:
  pdf_document:
    toc: yes
    toc_depth: 1
editor_options: 
  chunk_output_type: console
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# loading packages
library(rstanarm)
library(readxl) # from tidyverse package
library(rstan)
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())
library(bayesplot)
theme_set(bayesplot::theme_default())
library(rprojroot)
library(rvest)
library(corrplot)
root<-has_file("linear.rmd")$make_fix_file()
```

Data loading

```{r}
powerplant <- read_excel("Folds5x2_pp.xlsx")
powerplant <- as.data.frame(scale(powerplant))
head(powerplant)
corrplot(cor(powerplant), method="number")
```


```{r}
# this chunk requires rvest package
wiki_url <- read_html("http://wiki.stat.ucla.edu/socr/index.php/SOCR_Data_2011_US_JobsRanking")
html_nodes(wiki_url, "#content")
pd_data <- html_table(html_nodes(wiki_url,"table")[[2]])
head(pd_data)
job_scores <- subset(pd_data, select = -c(Index, Job_Title, Description))
corrplot(cor(job_scores), method="number")
```

Model fitting

```{r}
fit_pp <- stan_glm(PE ~ ., data=powerplant, refresh=0)
fit_jobs <- stan_glm(Overall_Score ~ ., data=job_scores, refresh=0)
draws <- as.data.frame(fit_jobs)
```

Model evaluation

```{r}
monitor(fit_pp$stanfit)
monitor(fit_jobs$stanfit)
loo(fit_pp)
loo(fit_jobs)
```